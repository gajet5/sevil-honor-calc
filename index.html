<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä Honor System</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 15px;
            background-color: #1e1e1e;
            color: #e0e0e0;
            line-height: 1.4;
        }
        
        .container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            max-width: 100%;
        }
        
        .section {
            background: #2d2d2d;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #444;
        }
        
        h1, h2, h3 {
            color: #ffd700;
            margin-bottom: 12px;
            font-size: clamp(16px, 4vw, 24px);
        }
        
        h2 {
            font-size: clamp(14px, 3.5vw, 20px);
        }
        
        h3 {
            font-size: clamp(13px, 3vw, 18px);
        }
        
        .input-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 6px;
            font-weight: bold;
            font-size: clamp(12px, 3vw, 14px);
        }
        
        input, select {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            background: #3d3d3d;
            border: 1px solid #555;
            border-radius: 6px;
            color: #fff;
            font-size: 16px; /* –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
            min-height: 44px; /* –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –¥–ª—è —Ç–∞—á-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ */
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        
        button {
            background: #ffd700;
            color: #1e1e1e;
            border: none;
            padding: 12px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            font-size: clamp(12px, 3vw, 14px);
            flex: 1;
            min-width: 120px;
            min-height: 44px;
        }
        
        button:hover {
            background: #ffed4a;
        }
        
        .info-box {
            background: #363636;
            padding: 12px;
            border-radius: 6px;
            margin: 10px 0;
            font-size: clamp(11px, 2.8vw, 13px);
        }
        
        /* –¢–∞–±–ª–∏—Ü—ã –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
        .table-container {
            overflow-x: auto;
            margin: 10px 0;
            -webkit-overflow-scrolling: touch;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 500px; /* –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –¥–ª—è —Å–∫—Ä–æ–ª–ª–∞ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
            font-size: clamp(10px, 2.5vw, 12px);
        }
        
        th, td {
            border: 1px solid #555;
            padding: 8px 6px;
            text-align: center;
            white-space: nowrap;
        }
        
        th {
            background: #444;
            color: #ffd700;
            font-weight: bold;
        }
        
        tr:nth-child(even) {
            background: #363636;
        }
        
        /* –ë–µ–π–¥–∂–∏ —É—Ä–æ–≤–Ω–µ–π */
        .tier-badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: clamp(9px, 2.5vw, 11px);
            font-weight: bold;
            margin: 1px;
        }
        
        .tier-top { background: #ff6b6b; color: #000; }
        .tier-high { background: #ffa500; color: #000; }
        .tier-medium { background: #4ecdc4; color: #000; }
        .tier-low { background: #45b7d1; color: #000; }
        .tier-minimal { background: #96ceb4; color: #000; }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –≥—Ä—É–ø–ø—ã */
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        
        .summary-item {
            background: #363636;
            padding: 10px;
            border-radius: 6px;
            font-size: clamp(11px, 2.8vw, 13px);
        }
        
        /* –ú–æ–±–∏–ª—å–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Ç–∞–±–ª–∏—Ü–∞–º */
        .table-nav {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
            gap: 10px;
        }
        
        .table-nav button {
            flex: 1;
            min-width: auto;
            padding: 8px 12px;
            font-size: clamp(10px, 2.5vw, 12px);
        }
        
        /* –£–ª—É—á—à–µ–Ω–∏—è –¥–ª—è –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
        @media (max-width: 480px) {
            body {
                padding: 10px;
            }
            
            .section {
                padding: 12px;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            button {
                min-width: 100%;
            }
            
            table {
                min-width: 600px; /* –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –¥–ª—è –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
            }
            
            th, td {
                padding: 6px 4px;
            }
        }
        
        /* –ü–æ—Ä—Ç—Ä–µ—Ç–Ω–∞—è –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è */
        @media (max-width: 768px) and (orientation: portrait) {
            .container {
                gap: 12px;
            }
        }
        
        /* –õ–∞–Ω–¥—à–∞—Ñ—Ç–Ω–∞—è –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è */
        @media (max-width: 768px) and (orientation: landscape) {
            .container {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 12px;
            }
            
            .input-section {
                grid-column: 1;
            }
            
            .results-section {
                grid-column: 2;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="section input-section">
            <h2>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—É–ª–∞</h2>
            
            <div class="input-group">
                <label for="poolSize">üë• –†–∞–∑–º–µ—Ä –ø—É–ª–∞ –∏–≥—Ä–æ–∫–æ–≤:</label>
                <input type="number" id="poolSize" value="100" min="1" max="1000">
            </div>
            
            <div class="input-group">
                <label for="minHK">üéØ –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ HK –¥–ª—è —É—á–∞—Å—Ç–∏—è:</label>
                <input type="number" id="minHK" value="15" min="0">
            </div>
            
            <div class="button-group">
                <button onclick="calculate()">üìä –†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
                <button onclick="resetToDefault()">üîÑ –°–±—Ä–æ—Å</button>
            </div>
            
            <div class="info-box">
                <strong>üìà BRK –∑–Ω–∞—á–µ–Ω–∏—è (1.12+ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ):</strong><br>
                0.010, 0.025, 0.045, 0.075, 0.120, 0.180, 0.250, 0.330, 0.420, 0.520, 0.630, 0.750, 0.880, 1.000
            </div>
            
            <div class="info-box">
                <strong>üèÜ RP –Ω–∞–≥—Ä–∞–¥—ã (FY):</strong><br>
                0, 400, 1000, 2000, 3000, 4000, 5000, 6000, 7000, 8000, 9000, 10000, 11000, 12000, 13000
            </div>
        </div>
        
        <div class="section results-section">
            <h2>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–∞</h2>
            
            <div class="table-nav">
                <button onclick="showTable('breakpoint')">üìã –ë—Ä–µ–π–∫–ø–æ–∏–Ω—Ç—ã</button>
                <button onclick="showTable('standing')">üéØ –ü–æ–∑–∏—Ü–∏–∏</button>
                <button onclick="showTable('summary')">üìà –°–≤–æ–¥–∫–∞</button>
            </div>
            
            <div id="breakpointTable" class="table-section">
                <h3>üéØ –ë—Ä–µ–π–∫–ø–æ–∏–Ω—Ç—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>BRK</th>
                                <th>–ó–Ω–∞—á–µ–Ω–∏–µ</th>
                                <th>–ü–æ–∑–∏—Ü–∏—è</th>
                                <th>RP</th>
                                <th>%</th>
                            </tr>
                        </thead>
                        <tbody id="breakpointBody">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div id="standingTable" class="table-section" style="display: none;">
                <h3>üìä –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –ø–æ–∑–∏—Ü–∏—è–º</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>–ü–æ–∑.</th>
                                <th>–£—Ä–æ–≤–µ–Ω—å</th>
                                <th>RP</th>
                                <th>–ü—Ä–∏–º–µ—Ä CP</th>
                                <th>–†–∞—Å—á–µ—Ç RP</th>
                            </tr>
                        </thead>
                        <tbody id="standingBody">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div id="summaryTable" class="table-section" style="display: none;">
                <h3>üìà –°–≤–æ–¥–∫–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è</h3>
                <div id="summaryContent" class="summary-grid">
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏–∑ HonorMgr.cpp
        const DEFAULT_BRK = [
            0.010,  // BRK[13]
            0.025,  // BRK[12]
            0.045,  // BRK[11]
            0.075,  // BRK[10]
            0.120,  // BRK[9]
            0.180,  // BRK[8]
            0.250,  // BRK[7]
            0.330,  // BRK[6]
            0.420,  // BRK[5]
            0.520,  // BRK[4]
            0.630,  // BRK[3]
            0.750,  // BRK[2]
            0.880,  // BRK[1]
            1.000   // BRK[0]
        ];

        const RP_REWARDS = [
            0,      // FY[0]
            400,    // FY[1]
            1000,   // FY[2]
            2000,   // FY[3]
            3000,   // FY[4]
            4000,   // FY[5]
            5000,   // FY[6]
            6000,   // FY[7]
            7000,   // FY[8]
            8000,   // FY[9]
            9000,   // FY[10]
            10000,  // FY[11]
            11000,  // FY[12]
            12000,  // FY[13]
            13000   // FY[14]
        ];

        let currentTable = 'breakpoint';

        function showTable(tableName) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã
            document.querySelectorAll('.table-section').forEach(table => {
                table.style.display = 'none';
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
            document.getElementById(tableName + 'Table').style.display = 'block';
            currentTable = tableName;
        }

        function calculateBreakpoints(poolSize) {
            const breakpoints = [];
            
            for (let i = 0; i < DEFAULT_BRK.length; i++) {
                const brkValue = DEFAULT_BRK[i];
                const position = Math.floor(brkValue * poolSize + 0.5);
                const rpReward = RP_REWARDS[RP_REWARDS.length - 1 - i];
                
                breakpoints.push({
                    index: i,
                    value: brkValue,
                    position: position,
                    rpReward: rpReward,
                    percentile: (brkValue * 100).toFixed(1) + '%'
                });
            }
            
            return breakpoints;
        }

        function generateStandingList(poolSize, breakpoints) {
            const standings = [];
            const groups = [];
            
            // –°–æ–∑–¥–∞–µ–º –≥—Ä—É–ø–ø—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –±—Ä–µ–π–∫–ø–æ–∏–Ω—Ç–æ–≤
            for (let i = breakpoints.length - 1; i > 0; i--) {
                const startPos = breakpoints[i].position + 1;
                const endPos = breakpoints[i - 1].position;
                const minRP = breakpoints[i].rpReward;
                const maxRP = breakpoints[i - 1].rpReward;
                
                if (startPos <= endPos) {
                    groups.push({
                        start: startPos,
                        end: endPos,
                        minRP: minRP,
                        maxRP: maxRP,
                        level: getTierLevel(i)
                    });
                }
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –ø–µ—Ä–≤—É—é –ø–æ–∑–∏—Ü–∏—é –æ—Ç–¥–µ–ª—å–Ω–æ
            if (breakpoints[breakpoints.length - 1].position >= 1) {
                groups.unshift({
                    start: 1,
                    end: breakpoints[breakpoints.length - 1].position,
                    minRP: breakpoints[breakpoints.length - 1].rpReward,
                    maxRP: breakpoints[breakpoints.length - 1].rpReward,
                    level: '–¢–û–ü'
                });
            }
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø—Ä–∏–º–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏
            for (const group of groups) {
                const positionsInGroup = group.end - group.start + 1;
                let cpBase = (14000 - group.start * 100);
                
                for (let pos = group.start; pos <= group.end; pos++) {
                    const exampleCP = Math.max(100, cpBase - (pos - group.start) * 80);
                    const calculatedRP = calculateRpForPosition(pos, group.minRP, group.maxRP, positionsInGroup);
                    
                    standings.push({
                        position: pos,
                        level: group.level,
                        rpRange: `${group.minRP}-${group.maxRP}`,
                        exampleCP: Math.round(exampleCP),
                        calculatedRP: Math.round(calculatedRP)
                    });
                }
            }
            
            return { standings, groups };
        }

        function calculateRpForPosition(position, minRP, maxRP, groupSize) {
            if (groupSize <= 1) return maxRP;
            const progress = (position - 1) / (groupSize - 1);
            return minRP + (maxRP - minRP) * (1 - progress);
        }

        function getTierLevel(brkIndex) {
            const levels = ['–¢–û–ü', '–í–´–°–û–ö–ò–ô', '–°–†–ï–î–ù–ò–ô', '–ù–ò–ó–ö–ò–ô', '–ú–ò–ù–ò–ú–ê–õ–¨–ù–´–ô'];
            const levelIndex = Math.min(Math.floor(brkIndex / 3), levels.length - 1);
            return levels[levelIndex];
        }

        function getTierBadge(level) {
            const tierClasses = {
                '–¢–û–ü': 'tier-top',
                '–í–´–°–û–ö–ò–ô': 'tier-high', 
                '–°–†–ï–î–ù–ò–ô': 'tier-medium',
                '–ù–ò–ó–ö–ò–ô': 'tier-low',
                '–ú–ò–ù–ò–ú–ê–õ–¨–ù–´–ô': 'tier-minimal'
            };
            
            return `<span class="tier-badge ${tierClasses[level] || ''}">${level}</span>`;
        }

        function calculate() {
            const poolSize = parseInt(document.getElementById('poolSize').value);
            const minHK = parseInt(document.getElementById('minHK').value);
            
            if (poolSize < 1) {
                alert('–†–∞–∑–º–µ—Ä –ø—É–ª–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º —á–∏—Å–ª–æ–º');
                return;
            }
            
            // –†–∞—Å—á–µ—Ç –±—Ä–µ–π–∫–ø–æ–∏–Ω—Ç–æ–≤
            const breakpoints = calculateBreakpoints(poolSize);
            displayBreakpoints(breakpoints);
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ø–∏—Å–∫–∞ –ø–æ–∑–∏—Ü–∏–π
            const { standings, groups } = generateStandingList(poolSize, breakpoints);
            displayStandings(standings);
            displaySummary(groups, poolSize, minHK);
        }

        function displayBreakpoints(breakpoints) {
            const tbody = document.getElementById('breakpointBody');
            tbody.innerHTML = '';
            
            for (const bp of breakpoints) {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${13 - bp.index}</td>
                    <td>${bp.value.toFixed(3)}</td>
                    <td>#${bp.position}</td>
                    <td>${bp.rpReward.toLocaleString()}</td>
                    <td>${bp.percentile}</td>
                `;
                tbody.appendChild(row);
            }
        }

        function displayStandings(standings) {
            const tbody = document.getElementById('standingBody');
            tbody.innerHTML = '';
            
            // –î–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –º–µ–Ω—å—à–µ —Å—Ç—Ä–æ–∫
            const step = standings.length > 30 ? Math.ceil(standings.length / 15) : 1;
            
            for (let i = 0; i < standings.length; i += step) {
                const standing = standings[i];
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>#${standing.position}</td>
                    <td>${getTierBadge(standing.level)}</td>
                    <td>${standing.rpRange}</td>
                    <td>${standing.exampleCP}</td>
                    <td>${standing.calculatedRP}</td>
                `;
                tbody.appendChild(row);
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Å—Ç—Ä–æ–∫
            if (step > 1) {
                const infoRow = document.createElement('tr');
                infoRow.innerHTML = `<td colspan="5" style="text-align: center; font-style: italic;">
                    –ü–æ–∫–∞–∑–∞–Ω–æ ${Math.ceil(standings.length / step)} –∏–∑ ${standings.length} –ø–æ–∑–∏—Ü–∏–π
                </td>`;
                tbody.appendChild(infoRow);
            }
        }

        function displaySummary(groups, poolSize, minHK) {
            const summaryDiv = document.getElementById('summaryContent');
            let html = '';
            
            const activePlayers = groups.reduce((sum, group) => sum + (group.end - group.start + 1), 0);
            const inactivePlayers = Math.max(0, poolSize - activePlayers);
            
            // –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            html += `
                <div class="summary-item">
                    <strong>üìä –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</strong><br>
                    –ê–∫—Ç–∏–≤–Ω—ã—Ö: ${activePlayers} –∏–≥—Ä–æ–∫–æ–≤<br>
                    –ù–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö: ${inactivePlayers} –∏–≥—Ä–æ–∫–æ–≤<br>
                    –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ HK: ${minHK}
                </div>
            `;
            
            for (const group of groups) {
                const playersInGroup = group.end - group.start + 1;
                const percentage = ((playersInGroup / poolSize) * 100).toFixed(1);
                
                html += `
                    <div class="summary-item">
                        <strong>${getTierBadge(group.level)} –£—Ä–æ–≤–µ–Ω—å</strong><br>
                        –ú–µ—Å—Ç–∞: ${group.start}-${group.end}<br>
                        –ò–≥—Ä–æ–∫–æ–≤: ${playersInGroup} (${percentage}%)<br>
                        RP: ${group.minRP}-${group.maxRP}
                    </div>
                `;
            }
            
            summaryDiv.innerHTML = html;
        }

        function resetToDefault() {
            document.getElementById('poolSize').value = 100;
            document.getElementById('minHK').value = 15;
            calculate();
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ä–∞–∑–º–µ—Ä–∞ —ç–∫—Ä–∞–Ω–∞
        window.addEventListener('resize', function() {
            // –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            if (window.innerHeight > window.innerWidth) {
                // –ü–æ—Ä—Ç—Ä–µ—Ç–Ω–∞—è –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è
                document.body.style.padding = '10px';
            } else {
                // –õ–∞–Ω–¥—à–∞—Ñ—Ç–Ω–∞—è –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è
                document.body.style.padding = '15px';
            }
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            calculate();
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
            document.getElementById('poolSize').addEventListener('change', calculate);
            document.getElementById('minHK').addEventListener('change', calculate);
        });
    </script>
</body>
</html>